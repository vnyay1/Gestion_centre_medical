/* ============================================================
   TRANSLATIONS – Medical Center Project
   ============================================================ */

const translations = {
    fr: {
        // Common
        dashboard: "Dashboard",
        doctors: "Médecins",
        patients: "Patients",
        services: "Services",
        appointments: "Rendez-vous",
        consultations: "Consultations",
        logout: "Déconnexion",
        medicalCenter: "Centre Médical",
        actions: "Actions",
        search: "Rechercher...",
        
        // Login
        loginTitle: "Centre Médical – Connexion",
        email: "Email",
        password: "Mot de passe",
        login: "Se connecter",
        invalidEmail: "Email invalide",
        passwordRequired: "Mot de passe requis",
        language: "Langue",
        credentials: "Identifiants de test",
        
        // Dashboard
        dashboardTitle: "Dashboard",
        totalPatients: "Total Patients",
        totalDoctors: "Total Médecins",
        appointmentsMonth: "Rendez-vous (Mois)",
        appointmentsByStatus: "Rendez-vous par statut",
        doctorSpecialties: "Spécialités des médecins",
        
        // Doctors
        doctorsList: "Liste des médecins",
        addDoctor: "+ Ajouter un Médecin",
        doctorAdd: "Ajouter un médecin",
        doctorEdit: "Modifier un médecin",
        doctorDetails: "Détails du médecin",
        name: "Nom",
        fullname: "Nom complet",
        specialty: "Spécialité",
        phone: "Téléphone",
        available: "Disponible",
        
        // Patients
        patientsList: "Liste des patients",
        addPatient: "+ Ajouter un Patient",
        patientAdd: "Ajouter un patient",
        patientEdit: "Modifier un patient",
        patientDetails: "Détails du patient",
        dateOfBirth: "Date de naissance",
        address: "Adresse",
        age: "Âge",
        gender: "Sexe",
        male: "Homme",
        female: "Femme",
        medicalHistory: "Antécédents médicaux",
        
        // Services
        servicesList: "Liste des services",
        addService: "+ Ajouter un Service",
        serviceAdd: "Ajouter un service médical",
        serviceEdit: "Modifier un service médical",
        serviceDetails: "Détails du service médical",
        serviceName: "Nom du service",
        description: "Description",
        price: "Prix",
        tariff: "Tarif (Dhs)",
        
        // Appointments
        appointmentsList: "Liste des rendez-vous",
        addAppointment: "+ Ajouter un Rendez-vous",
        appointmentAdd: "Nouveau rendez-vous",
        appointmentEdit: "Modifier un rendez-vous",
        appointmentDetails: "Détails du rendez-vous",
        date: "Date",
        time: "Heure",
        status: "Statut",
        doctor: "Médecin",
        patient: "Patient",
        pending: "En attente",
        confirmed: "Confirmé",
        cancelled: "Annulé",
        
        // Consultations
        consultationsList: "Liste des consultations",
        addConsultation: "+ Ajouter une Consultation",
        consultationAdd: "Nouvelle consultation",
        consultationEdit: "Modifier une consultation",
        consultationDetails: "Détails de la consultation",
        notes: "Notes",
        diagnosis: "Diagnostic",
        reason: "Motif",
        consultationDate: "Date de consultation",
        
        // Buttons
        save: "Enregistrer",
        cancel: "Annuler",
        create: "Créer",
        update: "Modifier",
        remove: "Supprimer",
        back: "Retour",
        edit: "Modifier",
        delete: "Supprimer",
        details: "Détails",
        
        // Messages
        confirmDelete: "Êtes-vous sûr de vouloir supprimer ?",
        success: "Opération réussie",
        error: "Une erreur est survenue",
        noData: "Aucune donnée disponible",
        required: "Ce champ est requis",
    },
    
    en: {
        // Common
        dashboard: "Dashboard",
        doctors: "Doctors",
        patients: "Patients",
        services: "Services",
        appointments: "Appointments",
        consultations: "Consultations",
        logout: "Logout",
        medicalCenter: "Medical Center",
        actions: "Actions",
        search: "Search...",
        
        // Login
        loginTitle: "Medical Center – Login",
        email: "Email",
        password: "Password",
        login: "Login",
        invalidEmail: "Invalid email",
        passwordRequired: "Password required",
        language: "Language",
        credentials: "Test credentials",
        
        // Dashboard
        dashboardTitle: "Dashboard",
        totalPatients: "Total Patients",
        totalDoctors: "Total Doctors",
        appointmentsMonth: "Appointments (Month)",
        appointmentsByStatus: "Appointments by status",
        doctorSpecialties: "Doctor specialties",
        
        // Doctors
        doctorsList: "Doctors List",
        addDoctor: "+ Add a Doctor",
        doctorAdd: "Add a doctor",
        doctorEdit: "Edit a doctor",
        doctorDetails: "Doctor Details",
        name: "Name",
        fullname: "Full Name",
        specialty: "Specialty",
        phone: "Phone",
        available: "Available",
        
        // Patients
        patientsList: "Patients List",
        addPatient: "+ Add a Patient",
        patientAdd: "Add a patient",
        patientEdit: "Edit a patient",
        patientDetails: "Patient Details",
        dateOfBirth: "Date of Birth",
        address: "Address",
        age: "Age",
        gender: "Gender",
        male: "Male",
        female: "Female",
        medicalHistory: "Medical History",
        
        // Services
        servicesList: "Services List",
        addService: "+ Add a Service",
        serviceAdd: "Add a medical service",
        serviceEdit: "Edit a medical service",
        serviceDetails: "Medical Service Details",
        serviceName: "Service Name",
        description: "Description",
        price: "Price",
        tariff: "Price (Dhs)",
        
        // Appointments
        appointmentsList: "Appointments List",
        addAppointment: "+ Add an Appointment",
        appointmentAdd: "New appointment",
        appointmentEdit: "Edit an appointment",
        appointmentDetails: "Appointment Details",
        date: "Date",
        time: "Time",
        status: "Status",
        doctor: "Doctor",
        patient: "Patient",
        pending: "Pending",
        confirmed: "Confirmed",
        cancelled: "Cancelled",
        
        // Consultations
        consultationsList: "Consultations List",
        addConsultation: "+ Add a Consultation",
        consultationAdd: "New consultation",
        consultationEdit: "Edit a consultation",
        consultationDetails: "Consultation Details",
        notes: "Notes",
        diagnosis: "Diagnosis",
        reason: "Reason",
        consultationDate: "Consultation Date",
        
        // Buttons
        save: "Save",
        cancel: "Cancel",
        create: "Create",
        update: "Update",
        remove: "Remove",
        back: "Back",
        edit: "Edit",
        delete: "Delete",
        details: "Details",
        
        // Messages
        confirmDelete: "Are you sure you want to delete?",
        success: "Operation successful",
        error: "An error occurred",
        noData: "No data available",
        required: "This field is required",
    },
    
    ar: {
        // Common
        dashboard: "لوحة التحكم",
        doctors: "الأطباء",
        patients: "المرضى",
        services: "الخدمات",
        appointments: "المواعيد",
        consultations: "الاستشارات",
        logout: "تسجيل خروج",
        medicalCenter: "مركز طبي",
        actions: "الإجراءات",
        search: "بحث...",
        
        // Login
        loginTitle: "مركز طبي – دخول",
        email: "البريد الإلكتروني",
        password: "كلمة المرور",
        login: "دخول",
        invalidEmail: "بريد إلكتروني غير صحيح",
        passwordRequired: "كلمة المرور مطلوبة",
        language: "اللغة",
        credentials: "بيانات الاختبار",
        
        // Dashboard
        dashboardTitle: "لوحة التحكم",
        totalPatients: "إجمالي المرضى",
        totalDoctors: "إجمالي الأطباء",
        appointmentsMonth: "المواعيد (هذا الشهر)",
        appointmentsByStatus: "المواعيد حسب الحالة",
        doctorSpecialties: "تخصصات الأطباء",
        
        // Doctors
        doctorsList: "قائمة الأطباء",
        addDoctor: "+ إضافة طبيب",
        doctorAdd: "إضافة طبيب",
        doctorEdit: "تعديل طبيب",
        doctorDetails: "تفاصيل الطبيب",
        name: "الاسم",
        fullname: "الاسم الكامل",
        specialty: "التخصص",
        phone: "الهاتف",
        available: "متاح",
        
        // Patients
        patientsList: "قائمة المرضى",
        addPatient: "+ إضافة مريض",
        patientAdd: "إضافة مريض",
        patientEdit: "تعديل مريض",
        patientDetails: "تفاصيل المريض",
        dateOfBirth: "تاريخ الميلاد",
        address: "العنوان",
        age: "العمر",
        gender: "الجنس",
        male: "ذكر",
        female: "أنثى",
        medicalHistory: "السجل الطبي",
        
        // Services
        servicesList: "قائمة الخدمات",
        addService: "+ إضافة خدمة",
        serviceAdd: "إضافة خدمة طبية",
        serviceEdit: "تعديل خدمة طبية",
        serviceDetails: "تفاصيل الخدمة الطبية",
        serviceName: "اسم الخدمة",
        description: "الوصف",
        price: "السعر",
        tariff: "السعر (درهم)",
        
        // Appointments
        appointmentsList: "قائمة المواعيد",
        addAppointment: "+ إضافة موعد",
        appointmentAdd: "موعد جديد",
        appointmentEdit: "تعديل موعد",
        appointmentDetails: "تفاصيل الموعد",
        date: "التاريخ",
        time: "الوقت",
        status: "الحالة",
        doctor: "الطبيب",
        patient: "المريض",
        pending: "قيد الانتظار",
        confirmed: "مؤكد",
        cancelled: "ملغى",
        
        // Consultations
        consultationsList: "قائمة الاستشارات",
        addConsultation: "+ إضافة استشارة",
        consultationAdd: "استشارة جديدة",
        consultationEdit: "تعديل استشارة",
        consultationDetails: "تفاصيل الاستشارة",
        notes: "الملاحظات",
        diagnosis: "التشخيص",
        reason: "السبب",
        consultationDate: "تاريخ الاستشارة",
        
        // Buttons
        save: "حفظ",
        cancel: "إلغاء",
        create: "إنشاء",
        update: "تحديث",
        remove: "إزالة",
        back: "رجوع",
        edit: "تعديل",
        delete: "حذف",
        details: "التفاصيل",
        
        // Messages
        confirmDelete: "هل أنت متأكد من رغبتك في الحذف؟",
        success: "تمت العملية بنجاح",
        error: "حدث خطأ",
        noData: "لا توجد بيانات متاحة",
        required: "هذا الحقل مطلوب",
    }
};

// ============================================================
// TRANSLATION SERVICE
// ============================================================

class TranslationService {
    constructor() {
        this.currentLanguage = localStorage.getItem('selectedLanguage') || 'fr';
        this.updatePageLanguage();
        this.setupLanguageSelector();
    }
    
    /**
     * Get translated text
     */
    t(key) {
        return translations[this.currentLanguage][key] || translations['fr'][key] || key;
    }
    
    /**
     * Set language and update page
     */
    setLanguage(lang) {
        if (translations[lang]) {
            this.currentLanguage = lang;
            localStorage.setItem('selectedLanguage', lang);
            this.updatePageLanguage();
        }
    }
    
    /**
     * Update all translatable elements on the page
     */
    updatePageLanguage() {
        document.documentElement.lang = this.currentLanguage;
        document.documentElement.dir = this.currentLanguage === 'ar' ? 'rtl' : 'ltr';
        
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            el.textContent = this.t(key);
        });
        
        // Update all placeholders with data-i18n-placeholder attribute
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            el.placeholder = this.t(key);
        });
        
        // Update all titles with data-i18n-title attribute
        document.querySelectorAll('[data-i18n-title]').forEach(el => {
            const key = el.getAttribute('data-i18n-title');
            el.title = this.t(key);
        });
        
        // Emit custom event for other scripts to listen to
        document.dispatchEvent(new CustomEvent('languageChanged', { detail: { language: this.currentLanguage } }));
    }
    
    /**
     * Setup language selector if it exists
     */
    setupLanguageSelector() {
        const langSelect = document.getElementById('langSelect');
        if (langSelect) {
            langSelect.value = this.currentLanguage;
            langSelect.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
    }
    
    /**
     * Get current language
     */
    getLanguage() {
        return this.currentLanguage;
    }
}

// Initialize translation service when DOM is ready
let i18n;
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
        i18n = new TranslationService();
    });
} else {
    i18n = new TranslationService();
}
